(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[244],{4077:function(e,t,a){Promise.resolve().then(a.bind(a,9890))},9890:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var r=a(7437),s=a(2265),n=a(6463),l=a(1543);let i={C1:{id:"C1",name:"Ty-Koad — 2 chambres / 2 SDB",basePrice:70,minNights:2,deposit:150,animalsAllowed:!0,externalOnly:!1,maxGuests:4},C2:{id:"C2",name:"Ty-Koad Duo — spa privatif",priceWeekend:150,priceWeek:130,minNights:1,deposit:500,animalsAllowed:!0,externalOnly:!1,bookingUrl:"https://www.booking.com/",maxGuests:2}};function c(e){return new Date(e).toISOString().slice(0,10)}function o(e,t){if(!e||!t)return 0;let a=new Date(e),r=new Date(t);return a.setHours(12,0,0,0),r.setHours(12,0,0,0),Math.max(0,Math.round((r-a)/864e5))}let d=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],u=e=>{let t=e.getDay();return 5===t||6===t};function m(e){return new Date(e.getFullYear(),e.getMonth(),1)}function x(e,t){let a=new Date(e);return a.setMonth(a.getMonth()+t),a}function h(e){let t=m(e),a=(t.getDay()+6)%7,r=new Date(t);return r.setDate(t.getDate()-a),r}function p(e){let{chaletId:t="C1",months:a=3,className:n="",onChange:l}=e,d=i[t],u=(0,s.useMemo)(()=>{let e=new Date;return e.setHours(12,0,0,0),e},[]),p=(0,s.useMemo)(()=>c(u),[u]),f=(0,s.useMemo)(()=>m(u),[u]),[b,j]=(0,s.useState)(m(new Date)),[v,N]=(0,s.useState)(new Set),[y,w]=(0,s.useState)(!1),[C,k]=(0,s.useState)(""),[S,D]=(0,s.useState)("");(0,s.useEffect)(()=>{let e=!1;return(async()=>{w(!0);let a=c(h(x(b,-1))),r=c(h(x(b,13))),s="/api/availability?chalet=".concat(t,"&from=").concat(a,"&to=").concat(r);try{let t=await fetch(s),a=await t.json();e||N(new Set(a.bookedDates||[]))}finally{e||w(!1)}})(),()=>{e=!0}},[t,b]);let M=o(C,S),{total:R}=function(e,t,a){let r=o(t,a);if(!r||!e)return{nights:0,total:0};if("C1"===e.id)return{nights:r,total:e.basePrice*r};let s=0;for(let a of function*(e,t){let a=new Date(e);for(let e=0;e<t;e++){let t=new Date(a);t.setDate(a.getDate()+e),yield t}}(t,r)){let t=a.getDay();s+=5===t||6===t?e.priceWeekend:e.priceWeek}return{nights:r,total:s}}(d,C,S),I=0!==M&&M>=d.minNights;(0,s.useEffect)(()=>{null==l||l({chalet:d,checkIn:C,checkOut:S,nights:M,total:R,valid:I})},[d,C,S,M,R,I,l]);let A=(0,s.useMemo)(()=>Array.from({length:a},(e,t)=>x(b,t)),[b,a]);function E(){k(""),D("")}function F(e){k(e),D("")}function L(e){if(C&&!S&&e===C){E();return}if(!(e<p)&&!v.has(e)){if(!C){F(e);return}if(!S){if(e<=C){F(e);return}if(o(C,e)<d.minNights||function(e,t){if(!e||!t)return!1;let a=new Date(e),r=new Date(t);if(a.setHours(12,0,0,0),r.setHours(12,0,0,0),a<u||r<=u)return!0;for(let e=new Date(a);e<r;e.setDate(e.getDate()+1))if(v.has(c(e)))return!0;return!1}(C,e))return;D(e);return}F(e)}}function O(e){if(!C||!S)return!1;let t=c(e);return t>C&&t<S}function P(e){return C&&c(e)===C}function q(e){return S&&c(e)===S}let U=(0,s.useMemo)(()=>x(b,-1)<f,[b,f]);return(0,r.jsxs)("div",{className:"relative z-0 ".concat(n||""),children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4",children:[(0,r.jsx)("div",{className:"text-sm text-slate-700",children:C?(0,r.jsxs)(r.Fragment,{children:[new Date(C).toLocaleDateString("fr-FR")," →"," ",S?new Date(S).toLocaleDateString("fr-FR"):"…"," •"," ",(0,r.jsx)("b",{children:M})," nuit",M>1?"s":""," ",M>0&&!I&&(0,r.jsxs)("span",{className:"text-amber-700 ml-1",children:["(min ",d.minNights,")"]}),M>0&&I&&(0,r.jsxs)("span",{className:"ml-1",children:["• total"," ",R.toLocaleString("fr-FR",{style:"currency",currency:"EUR"})]})]}):"Clique sur ta date d’arriv\xe9e puis sur ta date de d\xe9part"}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:["C2"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"inline-flex items-center rounded-full bg-emerald-600/10 text-emerald-800 px-2 py-0.5 border border-emerald-300",children:"Dim-jeu 130 €"}),(0,r.jsx)("span",{className:"inline-flex items-center rounded-full bg-amber-500/10 text-amber-800 px-2 py-0.5 border border-amber-300",children:"Ven-sam 150 €"})]}),(0,r.jsx)("button",{type:"button",onClick:E,className:"px-2 py-1 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",title:"R\xe9initialiser la s\xe9lection",children:"R\xe9initialiser"}),(0,r.jsx)("span",{className:"text-slate-500",children:y?"Mise \xe0 jour…":"Dates barr\xe9es = indisponibles"})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("button",{onClick:()=>!U&&j(x(b,-1)),disabled:U,className:"px-2 py-1 rounded-lg border border-slate-300 ".concat(U?"opacity-40 cursor-not-allowed":"hover:bg-slate-50"),"aria-label":"Mois pr\xe9c\xe9dent",children:"‹"}),(0,r.jsx)("div",{className:"text-sm text-slate-700",children:i[t].name}),(0,r.jsx)("button",{onClick:()=>j(x(b,1)),className:"px-2 py-1 rounded-lg border border-slate-300 hover:bg-slate-50","aria-label":"Mois suivant",children:"›"})]}),(0,r.jsx)("div",{className:"grid md:grid-cols-3 gap-4",children:A.map((e,t)=>(0,r.jsx)(g,{date:e,busy:v,today:u,checkIn:C,checkOut:S,minNights:d.minNights,onPick:L,inRange:O,isStart:P,isEnd:q},t))}),(0,r.jsxs)("div",{className:"mt-3 text-[11px] text-slate-600",children:[(0,r.jsx)("span",{className:"inline-block align-middle h-2.5 w-5 mr-1 rounded",style:{backgroundImage:"repeating-linear-gradient(135deg, rgba(239,68,68,.36) 0, rgba(239,68,68,.36) 10px, transparent 10px, transparent 20px)"}}),(0,r.jsx)("span",{children:"Indisponible"})]})]})}function g(e){let{date:t,busy:a,today:s,checkIn:n,checkOut:l,minNights:i,onPick:m,inRange:x,isStart:p,isEnd:g}=e,f=t.toLocaleDateString("fr-FR",{month:"long",year:"numeric"}),b=h(t),j=Array.from({length:42},(e,t)=>{let a=new Date(b);return a.setDate(b.getDate()+t),a}),v=t.getMonth();return(0,r.jsxs)("div",{className:"bg-white/95 border border-slate-200 rounded-3xl p-3 shadow-sm hover:shadow-md transition",children:[(0,r.jsx)("div",{className:"text-center font-semibold capitalize text-slate-800",children:f}),(0,r.jsx)("div",{className:"mt-2 grid grid-cols-7 text-[11px] text-slate-500",children:d.map(e=>(0,r.jsx)("div",{className:"text-center py-1",children:e},e))}),(0,r.jsx)("div",{className:"grid grid-cols-7 gap-1",children:j.map((e,t)=>{let d=e.getMonth()===v,h=c(e),f=a.has(h),b=e<s,j=u(e)?"bg-emerald-50":"bg-white",N=!1;n&&h>n&&!l&&o(n,h)<(i||1)&&(N=!0);let y=f||b||N,w=p(e),C=g(e),k=x(e),S=h===c(s);return(0,r.jsxs)("button",{onClick:()=>!y&&m(h),type:"button",disabled:y,className:["relative h-9 rounded-lg text-[12px] flex items-center justify-center border",d?j:"bg-slate-50 text-slate-400","border-slate-200 text-slate-800",y?"opacity-60 cursor-not-allowed":"hover:bg-slate-50",w||C?"ring-2 ring-emerald-500 bg-emerald-50 font-semibold":"",k?"bg-emerald-100/40":""].join(" "),style:f?{backgroundImage:"repeating-linear-gradient(135deg, rgba(239,68,68,.36) 0, rgba(239,68,68,.36) 10px, transparent 10px, transparent 20px)"}:N?{backgroundImage:"repeating-linear-gradient(45deg, rgba(16,185,129,.22) 0, rgba(16,185,129,.22) 6px, transparent 6px, transparent 12px)"}:void 0,"aria-label":h,title:f?"Indisponible":b?"Pass\xe9":N?"Minimum ".concat(i," nuits"):"S\xe9lectionner",children:[e.getDate(),S&&(0,r.jsx)("span",{className:"absolute -bottom-1 h-1.5 w-1.5 rounded-full bg-emerald-600"})]},t)})})]})}function f(e){return(e||0).toLocaleString("fr-FR",{style:"currency",currency:"EUR"})}function b(){return(0,r.jsxs)("div",{children:[(0,r.jsx)(l.default,{}),(0,r.jsx)("div",{className:"h-16 md:h-16"}),(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"max-w-6xl mx-auto px-4 py-12 md:py-16",children:"Chargement de la r\xe9servation…"}),children:(0,r.jsx)(j,{})})]})}function j(){var e,t;let a=((0,n.useSearchParams)().get("tab")||"C1").toUpperCase(),[l,c]=(0,s.useState)(a),[o,d]=(0,s.useState)({}),[u,m]=(0,s.useState)(2),[x,h]=(0,s.useState)(0),[g,b]=(0,s.useState)(""),[j,v]=(0,s.useState)(null),N=null!==(e=null==j?void 0:j.valueCents)&&void 0!==e?e:0;(0,s.useEffect)(()=>{c(a),v(null),b("")},[a]);let y=i[l],w=null!==(t=y.maxGuests)&&void 0!==t?t:2,C=u+x;(0,s.useEffect)(()=>{if(C>w){let e=Math.min(u,Math.max(1,w-x)),t=Math.max(0,Math.min(x,w-e));m(e),h(t)}},[l]);let k=(0,s.useMemo)(()=>(null==o?void 0:o.nights)?f(Math.max(0,(o.total||0)-N)):"",[o,N]),S=C<1?"Merci d’indiquer au moins 1 adulte.":C>w?"Capacit\xe9 max : ".concat(w," personne").concat(w>1?"s":"","."):u<1?"Au moins 1 adulte requis.":"";async function D(){try{if(!(null==g?void 0:g.trim()))return;if(!(null==o?void 0:o.checkIn)||!(null==o?void 0:o.checkOut)){alert("Choisis d’abord tes dates");return}let e=await fetch("/api/gift/redeem",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:g.trim().toUpperCase(),chalet:l,checkIn:o.checkIn,checkOut:o.checkOut})}),t=await e.json();if(!e.ok){alert(t.error||"Code invalide"),v(null);return}v(t)}catch(e){alert(e.message)}}function M(){v(null),b("")}return(0,r.jsxs)("section",{className:"max-w-6xl mx-auto px-4 py-12 md:py-16",children:[(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold",children:"R\xe9server"}),(0,r.jsx)("p",{className:"mt-2 text-stone-600",children:"Choisis ton chalet puis tes dates."}),(0,r.jsx)("div",{className:"mt-6 inline-flex rounded-xl border border-stone-200 overflow-hidden",children:["C1","C2"].map(e=>(0,r.jsx)("button",{onClick:()=>{c(e),M()},className:"px-4 py-2 text-sm ".concat(l===e?"bg-emerald-900 text-white":"bg-white hover:bg-stone-50"),children:i[e].name},e))}),(0,r.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mr-2 text-stone-700",children:"Adultes :"}),(0,r.jsx)("select",{value:u,onChange:e=>{let t=+e.target.value;m(t),t+x>w&&h(Math.max(0,w-t))},className:"rounded-xl border border-stone-300 px-2 py-1",children:Array.from({length:w},(e,t)=>t+1).map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"mr-2 text-stone-700",children:"Enfants :"}),(0,r.jsx)("select",{value:x,onChange:e=>{let t=+e.target.value;u+t>w||h(t)},className:"rounded-xl border border-stone-300 px-2 py-1",children:Array.from({length:Math.max(0,w-u+1)},(e,t)=>t).map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{className:"text-stone-500",children:["Capacit\xe9 : max ",w," pers."]})]}),S&&(0,r.jsx)("div",{className:"mt-2 text-sm text-red-700",children:S}),(0,r.jsx)("div",{className:"mt-6",children:["C1","C2"].includes(l)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p,{chaletId:l,months:3,onChange:d}),(0,r.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[(0,r.jsx)("input",{value:g,onChange:e=>b(e.target.value),placeholder:"Code cadeau",className:"rounded-xl border border-stone-300 px-3 py-2"}),(0,r.jsx)("button",{onClick:D,className:"px-3 py-2 rounded-xl border",children:"Appliquer"}),j&&(0,r.jsx)("button",{onClick:M,className:"text-sm text-stone-600 underline",children:"Retirer"})]}),(0,r.jsxs)("div",{className:"mt-6 flex flex-wrap items-center gap-3",children:[(0,r.jsx)("div",{className:"text-sm text-stone-700",children:(null==o?void 0:o.nights)>0?(0,r.jsxs)(r.Fragment,{children:["S\xe9jour de ",(0,r.jsx)("b",{children:o.nights})," nuit",o.nights>1?"s":""," —"," ",j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"line-through mr-1",children:f(o.total)}),(0,r.jsx)("b",{children:k})," ",(0,r.jsxs)("span",{className:"text-emerald-800",children:["(",j.message,")"]})]}):(0,r.jsx)("b",{children:f(o.total)})," ","— caution ",f(i[l].deposit)]}):"S\xe9lectionne tes dates pour voir le total"}),(0,r.jsx)("button",{onClick:function(){let{checkIn:e,checkOut:t,nights:a,total:r}=o,s=Math.max(0,(r||0)-N),n=new URLSearchParams({chalet:y.id,ci:e,co:t,nights:String(a),amount:String(s/100*100),deposit:String(y.deposit),adults:String(u),children:String(x),...j?{giftCode:g.trim().toUpperCase(),giftValue:String(N)}:{}}).toString();location.assign("/payer?".concat(n))},disabled:!(null==o?void 0:o.valid)||!!S,className:"px-4 py-2 rounded-xl ".concat((null==o?void 0:o.valid)&&!S?"bg-emerald-900 text-white":"bg-stone-200 text-stone-500 cursor-not-allowed"),children:"R\xe9server maintenant"})]})]})})]})}},1543:function(e,t,a){"use strict";a.d(t,{default:function(){return o}});var r=a(7437),s=a(7138),n=a(5647),l=a.n(n);function i(e){let{className:t=""}=e;return(0,r.jsxs)(s.default,{href:"/","aria-label":"Accueil — Les Chalets Ty-Koad",className:"flex items-center gap-3 ".concat(t),children:[(0,r.jsx)(c,{className:"h-8 w-8 text-emerald-900"}),(0,r.jsxs)("span",{className:"".concat(l().className," text-lg md:text-xl leading-none tracking-wide"),children:["Les Chalets ",(0,r.jsx)("span",{className:"text-emerald-900",children:"Ty-Koad"})]})]})}function c(e){let{className:t=""}=e;return(0,r.jsx)("svg",{viewBox:"0 0 24 24",className:t,fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,r.jsxs)("g",{transform:"translate(12 12)",children:[(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{d:"M0 -6a6 6 0 1 1 -4.24 1.76"}),(0,r.jsx)("circle",{cx:"0",cy:"-6",r:"1.4",fill:"currentColor",stroke:"none"})]}),(0,r.jsxs)("g",{transform:"rotate(120)",children:[(0,r.jsx)("path",{d:"M0 -6a6 6 0 1 1 -4.24 1.76"}),(0,r.jsx)("circle",{cx:"0",cy:"-6",r:"1.4",fill:"currentColor",stroke:"none"})]}),(0,r.jsxs)("g",{transform:"rotate(240)",children:[(0,r.jsx)("path",{d:"M0 -6a6 6 0 1 1 -4.24 1.76"}),(0,r.jsx)("circle",{cx:"0",cy:"-6",r:"1.4",fill:"currentColor",stroke:"none"})]})]})})}function o(){return(0,r.jsx)("header",{id:"site-header",style:{position:"fixed",top:0,left:0,right:0,zIndex:2147483647},className:"bg-white/90 backdrop-blur border-b border-emerald-100 shadow-sm",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,r.jsx)(i,{}),(0,r.jsxs)("nav",{className:"hidden md:flex items-center gap-6 text-sm text-stone-700",children:[(0,r.jsx)(s.default,{href:"/nuit",className:"hover:text-emerald-800",children:"Douce nuit"}),(0,r.jsx)(s.default,{href:"/spa",className:"hover:text-rose-700",children:"Spa privatif"}),(0,r.jsx)(s.default,{href:"/autour",className:"hover:text-sky-700",children:"Autour"}),(0,r.jsx)(s.default,{href:"/gourmets",className:"hover:text-emerald-800",children:"Gourmets"}),(0,r.jsx)(s.default,{href:"/infos-pratiques",className:"hover:text-emerald-800",children:"Infos pratiques"}),(0,r.jsx)(s.default,{href:"/cadeau",className:"hover:text-rose-700",children:"Ch\xe8que cadeau"}),(0,r.jsx)(s.default,{href:"/contact",className:"hover:text-sky-700",children:"Contact"}),(0,r.jsx)(s.default,{href:"/reserver",className:"px-4 py-2 rounded-xl bg-emerald-700 hover:bg-emerald-800 text-white shadow-sm",children:"R\xe9server"})]}),(0,r.jsx)(s.default,{href:"/reserver",className:"md:hidden px-3 py-1 rounded-lg bg-emerald-700 hover:bg-emerald-800 text-white text-sm shadow-sm",children:"R\xe9server"})]})})}},6463:function(e,t,a){"use strict";var r=a(1169);a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[599,44,971,23,744],function(){return e(e.s=4077)}),_N_E=e.O()}]);
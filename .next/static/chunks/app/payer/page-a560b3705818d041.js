(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[943],{5031:function(e,t,r){Promise.resolve().then(r.bind(r,165))},165:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var s=r(7437),a=r(2265),n=r(6463),i=r(3537),l=r(7345),d=r(1543);let c=(0,i.J)("pk_live_51RsgI0H2RLtjddNaCiQzSYSbfm0X1PJu8HRBW0s730t6ySU0RoGF3o59bAu2xsGLWCl0cEfmLKIoyX0VM3z8dQkG00tTveBCSi");function o(e){return(e/100).toLocaleString("fr-FR",{style:"currency",currency:"EUR"})}function u(){let e=(0,n.useSearchParams)(),t=(0,l.useStripe)(),r=(0,l.useElements)(),i=Math.round(100*Number(e.get("amount")||0)),d=Math.round(100*Number(e.get("deposit")||0)),c=e.get("chalet"),u=e.get("ci"),m=e.get("co"),x=Number(e.get("nights")||0),h=e.get("giftCode")||"",f=Number(e.get("giftValue")||0),[p,j]=(0,a.useState)(null),[g,y]=(0,a.useState)("init"),[N,v]=(0,a.useState)("");async function b(){if(!t||!r)return;y("paying");let{error:e}=await t.confirmPayment({elements:r,redirect:"if_required"});if(e){v(e.message||"Erreur"),y("error");return}if(h)try{await fetch("/api/gift/consume",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:h})})}catch(e){}y("done")}return((0,a.useEffect)(()=>{(async()=>{y("init");let e=await fetch("/api/stripe/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amountCents:i,depositCents:d,chalet:c,ci:u,co:m,nights:x,giftCode:h||void 0,giftValueCents:f||void 0})}),t=await e.json();e.ok?(j(t.clientSecret),y("ready")):(y("error"),v(t.error||"Erreur"))})()},[]),p)?(0,s.jsxs)("div",{className:"max-w-md mx-auto bg-white border rounded-2xl p-5",children:[(0,s.jsxs)("div",{className:"text-sm text-stone-600 mb-2",children:["Total \xe0 payer : ",(0,s.jsx)("b",{children:o(i)}),h&&" (bon appliqu\xe9)",(0,s.jsx)("br",{}),"Caution (s\xe9par\xe9e) : ",o(d)]}),(0,s.jsx)(l.PaymentElement,{}),(0,s.jsx)("button",{onClick:b,disabled:"ready"!==g,className:"w-full mt-4 px-4 py-2 rounded-xl bg-emerald-700 hover:bg-emerald-800 text-white shadow-sm",children:"paying"===g?"Paiement en cours…":"Payer"}),"done"===g&&(0,s.jsx)("div",{className:"mt-3 text-emerald-800",children:"Merci ! Paiement confirm\xe9."}),"error"===g&&(0,s.jsx)("div",{className:"mt-3 text-red-700",children:N})]}):(0,s.jsx)("div",{className:"p-6",children:"Pr\xe9paration du paiement…"})}function m(){return(0,s.jsxs)("div",{children:[(0,s.jsx)(d.default,{}),(0,s.jsx)("div",{className:"h-16"}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-12",children:(0,s.jsx)(l.Elements,{stripe:c,children:(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{className:"p-6",children:"Pr\xe9paration du paiement…"}),children:(0,s.jsx)(u,{})})})})]})}},1543:function(e,t,r){"use strict";r.d(t,{default:function(){return c}});var s=r(7437),a=r(7138),n=r(5647),i=r.n(n);function l(e){let{className:t=""}=e;return(0,s.jsxs)(a.default,{href:"/","aria-label":"Accueil — Les Chalets Ty-Koad",className:"flex items-center gap-3 ".concat(t),children:[(0,s.jsx)(d,{className:"h-8 w-8 text-emerald-900"}),(0,s.jsxs)("span",{className:"".concat(i().className," text-lg md:text-xl leading-none tracking-wide"),children:["Les Chalets ",(0,s.jsx)("span",{className:"text-emerald-900",children:"Ty-Koad"})]})]})}function d(e){let{className:t=""}=e;return(0,s.jsx)("svg",{viewBox:"0 0 24 24",className:t,fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,s.jsxs)("g",{transform:"translate(12 12)",children:[(0,s.jsxs)("g",{children:[(0,s.jsx)("path",{d:"M0 -6a6 6 0 1 1 -4.24 1.76"}),(0,s.jsx)("circle",{cx:"0",cy:"-6",r:"1.4",fill:"currentColor",stroke:"none"})]}),(0,s.jsxs)("g",{transform:"rotate(120)",children:[(0,s.jsx)("path",{d:"M0 -6a6 6 0 1 1 -4.24 1.76"}),(0,s.jsx)("circle",{cx:"0",cy:"-6",r:"1.4",fill:"currentColor",stroke:"none"})]}),(0,s.jsxs)("g",{transform:"rotate(240)",children:[(0,s.jsx)("path",{d:"M0 -6a6 6 0 1 1 -4.24 1.76"}),(0,s.jsx)("circle",{cx:"0",cy:"-6",r:"1.4",fill:"currentColor",stroke:"none"})]})]})})}function c(){return(0,s.jsx)("header",{id:"site-header",style:{position:"fixed",top:0,left:0,right:0,zIndex:2147483647},className:"bg-white/90 backdrop-blur border-b border-emerald-100 shadow-sm",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,s.jsx)(l,{}),(0,s.jsxs)("nav",{className:"hidden md:flex items-center gap-6 text-sm text-stone-700",children:[(0,s.jsx)(a.default,{href:"/nuit",className:"hover:text-emerald-800",children:"Douce nuit"}),(0,s.jsx)(a.default,{href:"/spa",className:"hover:text-rose-700",children:"Spa privatif"}),(0,s.jsx)(a.default,{href:"/autour",className:"hover:text-sky-700",children:"Autour"}),(0,s.jsx)(a.default,{href:"/gourmets",className:"hover:text-emerald-800",children:"Gourmets"}),(0,s.jsx)(a.default,{href:"/infos-pratiques",className:"hover:text-emerald-800",children:"Infos pratiques"}),(0,s.jsx)(a.default,{href:"/cadeau",className:"hover:text-rose-700",children:"Ch\xe8que cadeau"}),(0,s.jsx)(a.default,{href:"/contact",className:"hover:text-sky-700",children:"Contact"}),(0,s.jsx)(a.default,{href:"/reserver",className:"px-4 py-2 rounded-xl bg-emerald-700 hover:bg-emerald-800 text-white shadow-sm",children:"R\xe9server"})]}),(0,s.jsx)(a.default,{href:"/reserver",className:"md:hidden px-3 py-1 rounded-lg bg-emerald-700 hover:bg-emerald-800 text-white text-sm shadow-sm",children:"R\xe9server"})]})})}}},function(e){e.O(0,[599,44,627,971,23,744],function(){return e(e.s=5031)}),_N_E=e.O()}]);
"use strict";(()=>{var e={};e.id=386,e.ids=[386],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},4890:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>N,patchFetch:()=>w,requestAsyncStorage:()=>x,routeModule:()=>v,serverHooks:()=>j,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{POST:()=>f});var s=r(9303),o=r(8716),n=r(670),i=r(7070),p=r(3292),u=r.n(p),c=r(1017),d=r.n(c);let l=d().join(process.cwd(),"data"),m=d().join(l,"messages.json");async function h(){await u().mkdir(l,{recursive:!0});try{await u().access(m)}catch{await u().writeFile(m,"[]","utf-8")}}async function f(e){try{let{name:t="",email:r="",phone:a="",subject:s="Question g\xe9n\xe9rale",message:o="",website:n=""}=await e.json()||{};if(n)return i.NextResponse.json({ok:!0});if(!t||!r||!o)return i.NextResponse.json({error:"Champs manquants."},{status:400});if(o.length>2e3)return i.NextResponse.json({error:"Message trop long (2000 caract\xe8res max)."},{status:400});await h();let p=new Date().toISOString(),c={id:`${Date.now()}`,name:t,email:r,phone:a,subject:s,message:o,createdAt:p},d=JSON.parse(await u().readFile(m,"utf-8")||"[]");if(d.unshift(c),await u().writeFile(m,JSON.stringify(d,null,2),"utf-8"),process.env.RESEND_API_KEY&&process.env.RESEND_TO&&process.env.RESEND_FROM){let e=["Nouveau message Ty-Koad",`Date: ${p}`,`Nom: ${t}`,`Email: ${r}`,a?`T\xe9l\xe9phone: ${a}`:null,`Sujet: ${s}`,"",o].filter(Boolean).join("\n");try{await fetch("https://api.resend.com/emails",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.RESEND_API_KEY}`},body:JSON.stringify({from:process.env.RESEND_FROM,to:[process.env.RESEND_TO],reply_to:[r],subject:`Contact site â€” ${s}`,text:e})})}catch(e){}}return i.NextResponse.json({ok:!0})}catch(e){return i.NextResponse.json({error:e.message},{status:500})}}let v=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/contact/route",pathname:"/api/contact",filename:"route",bundlePath:"app/api/contact/route"},resolvedPagePath:"C:\\Users\\Nina\\Downloads\\ty-koad-v5_1\\ty-koad-demo-v5.1\\app\\api\\contact\\route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:x,staticGenerationAsyncStorage:g,serverHooks:j}=v,N="/api/contact/route";function w(){return(0,n.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,972],()=>r(4890));module.exports=a})();
"use strict";(()=>{var e={};e.id=638,e.ids=[638],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},3837:e=>{e.exports=require("util")},8868:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>m,patchFetch:()=>_,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>l,staticGenerationAsyncStorage:()=>d});var r={};a.r(r),a.d(r,{POST:()=>i});var u=a(9303),o=a(8716),n=a(670),s=a(3114);async function i(e){try{let t=new s.Z(process.env.STRIPE_SECRET_KEY),{chalet:a,planKey:r,extras:u=[],fromName:o,buyerEmail:n,toName:i,toEmail:c,message:p}=await e.json(),d={fruits:{label:"Plateau fruits de mer",unit_amount:6500},champagne:{label:"Champagne",unit_amount:4500},petales:{label:"P\xe9tales de rose",unit_amount:1500},charcuterie:{label:"Plateau charcuterie",unit_amount:3e3},petitdej2:{label:"Petit d\xe9jeuner (2 pers.)",unit_amount:2400}},l={c2_week:13e3,c2_weekend:15e3,c1_2n:14e3,c1_3n:21e3,c1_4n:28e3}[r];if(!l)return new Response(JSON.stringify({error:"Plan inconnu"}),{status:400});let m=[{price_data:{currency:"eur",unit_amount:l,product_data:{name:"C2"===a?"Ch\xe8que cadeau — Ty-Koad Duo (spa privatif)":"Ch\xe8que cadeau — Ty-Koad (2 ch / 2 SDB)",metadata:{planKey:r}}},quantity:1},...u.map(e=>({price_data:{currency:"eur",unit_amount:d[e]?.unit_amount||0,product_data:{name:d[e]?.label||e}},quantity:1}))],_=process.env.SITE_URL||"http://localhost:3000",h=await t.checkout.sessions.create({mode:"payment",customer_email:n||void 0,payment_method_types:["card"],line_items:m,success_url:`${_}/cadeau/succes?session_id={CHECKOUT_SESSION_ID}`,cancel_url:`${_}/cadeau`,metadata:{chalet:a,planKey:r,extrasCSV:(u||[]).join(","),fromName:o||"",buyerEmail:n||"",toName:i||"",toEmail:c||"",message:p||""}});return new Response(JSON.stringify({url:h.url}),{status:200})}catch(e){return console.error(e),new Response(JSON.stringify({error:e.message}),{status:500})}}let c=new u.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/gift/create-checkout/route",pathname:"/api/gift/create-checkout",filename:"route",bundlePath:"app/api/gift/create-checkout/route"},resolvedPagePath:"C:\\Users\\Nina\\Downloads\\ty-koad-v5_1\\ty-koad-demo-v5.1\\app\\api\\gift\\create-checkout\\route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:d,serverHooks:l}=c,m="/api/gift/create-checkout/route";function _(){return(0,n.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:d})}},9303:(e,t,a)=>{e.exports=a(517)}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948,749,114],()=>a(8868));module.exports=r})();
(()=>{var e={};e.id=244,e.ids=[244],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7634:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),r(7362),r(7764),r(5866);var s=r(3191),a=r(8716),n=r(7922),i=r.n(n),l=r(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["reserver",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7362)),"C:\\Users\\Nina\\Downloads\\ty-koad-v5_1\\ty-koad-demo-v5.1\\app\\reserver\\page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,7764)),"C:\\Users\\Nina\\Downloads\\ty-koad-v5_1\\ty-koad-demo-v5.1\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\Nina\\Downloads\\ty-koad-v5_1\\ty-koad-demo-v5.1\\app\\reserver\\page.jsx"],u="/reserver/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/reserver/page",pathname:"/reserver",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5816:()=>{},1877:(e,t,r)=>{Promise.resolve().then(r.bind(r,280))},3474:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},280:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var s=r(326),a=r(7577),n=r(5047),i=r(8249);let l={C1:{id:"C1",name:"Ty-Koad — 2 chambres / 2 SDB",basePrice:70,minNights:2,deposit:150,animalsAllowed:!0,externalOnly:!1,maxGuests:4},C2:{id:"C2",name:"Ty-Koad Duo — spa privatif",priceWeekend:150,priceWeek:130,minNights:1,deposit:500,animalsAllowed:!0,externalOnly:!1,bookingUrl:"https://www.booking.com/",maxGuests:2}};function o(e){return new Date(e).toISOString().slice(0,10)}function d(e,t){if(!e||!t)return 0;let r=new Date(e),s=new Date(t);return r.setHours(12,0,0,0),s.setHours(12,0,0,0),Math.max(0,Math.round((s-r)/864e5))}let c=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],u=e=>{let t=e.getDay();return 5===t||6===t};function m(e){return new Date(e.getFullYear(),e.getMonth(),1)}function x(e,t){let r=new Date(e);return r.setMonth(r.getMonth()+t),r}function h({chaletId:e="C1",months:t=3,className:r="",onChange:n}){let i=l[e],c=(0,a.useMemo)(()=>{let e=new Date;return e.setHours(12,0,0,0),e},[]),u=(0,a.useMemo)(()=>o(c),[c]),h=(0,a.useMemo)(()=>m(c),[c]),[g,f]=(0,a.useState)(m(new Date)),[b,j]=(0,a.useState)(new Set),[v,y]=(0,a.useState)(!1),[N,w]=(0,a.useState)(""),[k,C]=(0,a.useState)(""),D=d(N,k),{total:S}=function(e,t,r){let s=d(t,r);if(!s||!e)return{nights:0,total:0};if("C1"===e.id)return{nights:s,total:e.basePrice*s};let a=0;for(let r of function*(e,t){let r=new Date(e);for(let e=0;e<t;e++){let t=new Date(r);t.setDate(r.getDate()+e),yield t}}(t,s)){let t=r.getDay();a+=5===t||6===t?e.priceWeekend:e.priceWeek}return{nights:s,total:a}}(i,N,k),P=0!==D&&D>=i.minNights,M=(0,a.useMemo)(()=>Array.from({length:t},(e,t)=>x(g,t)),[g,t]);function _(){w(""),C("")}function q(e){w(e),C("")}function R(e){if(N&&!k&&e===N){_();return}if(!(e<u)&&!b.has(e)){if(!N){q(e);return}if(!k){if(e<=N){q(e);return}if(d(N,e)<i.minNights||function(e,t){if(!e||!t)return!1;let r=new Date(e),s=new Date(t);if(r.setHours(12,0,0,0),s.setHours(12,0,0,0),r<c||s<=c)return!0;for(let e=new Date(r);e<s;e.setDate(e.getDate()+1))if(b.has(o(e)))return!0;return!1}(N,e))return;C(e);return}q(e)}}function A(e){if(!N||!k)return!1;let t=o(e);return t>N&&t<k}function I(e){return N&&o(e)===N}function U(e){return k&&o(e)===k}let $=(0,a.useMemo)(()=>x(g,-1)<h,[g,h]);return(0,s.jsxs)("div",{className:`relative z-0 ${r||""}`,children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4",children:[s.jsx("div",{className:"text-sm text-slate-700",children:N?(0,s.jsxs)(s.Fragment,{children:[new Date(N).toLocaleDateString("fr-FR")," →"," ",k?new Date(k).toLocaleDateString("fr-FR"):"…"," •"," ",s.jsx("b",{children:D})," nuit",D>1?"s":""," ",D>0&&!P&&(0,s.jsxs)("span",{className:"text-amber-700 ml-1",children:["(min ",i.minNights,")"]}),D>0&&P&&(0,s.jsxs)("span",{className:"ml-1",children:["• total"," ",S.toLocaleString("fr-FR",{style:"currency",currency:"EUR"})]})]}):"Clique sur ta date d’arriv\xe9e puis sur ta date de d\xe9part"}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:["C2"===e&&(0,s.jsxs)(s.Fragment,{children:[s.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-600/10 text-emerald-800 px-2 py-0.5 border border-emerald-300",children:"Dim-jeu 130 €"}),s.jsx("span",{className:"inline-flex items-center rounded-full bg-amber-500/10 text-amber-800 px-2 py-0.5 border border-amber-300",children:"Ven-sam 150 €"})]}),s.jsx("button",{type:"button",onClick:_,className:"px-2 py-1 rounded-lg border border-slate-300 text-slate-700 hover:bg-slate-50",title:"R\xe9initialiser la s\xe9lection",children:"R\xe9initialiser"}),s.jsx("span",{className:"text-slate-500",children:v?"Mise \xe0 jour…":"Dates barr\xe9es = indisponibles"})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("button",{onClick:()=>!$&&f(x(g,-1)),disabled:$,className:`px-2 py-1 rounded-lg border border-slate-300 ${$?"opacity-40 cursor-not-allowed":"hover:bg-slate-50"}`,"aria-label":"Mois pr\xe9c\xe9dent",children:"‹"}),s.jsx("div",{className:"text-sm text-slate-700",children:l[e].name}),s.jsx("button",{onClick:()=>f(x(g,1)),className:"px-2 py-1 rounded-lg border border-slate-300 hover:bg-slate-50","aria-label":"Mois suivant",children:"›"})]}),s.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:M.map((e,t)=>s.jsx(p,{date:e,busy:b,today:c,checkIn:N,checkOut:k,minNights:i.minNights,onPick:R,inRange:A,isStart:I,isEnd:U},t))}),(0,s.jsxs)("div",{className:"mt-3 text-[11px] text-slate-600",children:[s.jsx("span",{className:"inline-block align-middle h-2.5 w-5 mr-1 rounded",style:{backgroundImage:"repeating-linear-gradient(135deg, rgba(239,68,68,.36) 0, rgba(239,68,68,.36) 10px, transparent 10px, transparent 20px)"}}),s.jsx("span",{children:"Indisponible"})]})]})}function p({date:e,busy:t,today:r,checkIn:a,checkOut:n,minNights:i,onPick:l,inRange:x,isStart:h,isEnd:p}){let g=e.toLocaleDateString("fr-FR",{month:"long",year:"numeric"}),f=function(e){let t=m(e),r=(t.getDay()+6)%7,s=new Date(t);return s.setDate(t.getDate()-r),s}(e),b=Array.from({length:42},(e,t)=>{let r=new Date(f);return r.setDate(f.getDate()+t),r}),j=e.getMonth();return(0,s.jsxs)("div",{className:"bg-white/95 border border-slate-200 rounded-3xl p-3 shadow-sm hover:shadow-md transition",children:[s.jsx("div",{className:"text-center font-semibold capitalize text-slate-800",children:g}),s.jsx("div",{className:"mt-2 grid grid-cols-7 text-[11px] text-slate-500",children:c.map(e=>s.jsx("div",{className:"text-center py-1",children:e},e))}),s.jsx("div",{className:"grid grid-cols-7 gap-1",children:b.map((e,c)=>{let m=e.getMonth()===j,g=o(e),f=t.has(g),b=e<r,v=u(e)?"bg-emerald-50":"bg-white",y=!1;a&&g>a&&!n&&d(a,g)<(i||1)&&(y=!0);let N=f||b||y,w=h(e),k=p(e),C=x(e),D=g===o(r);return(0,s.jsxs)("button",{onClick:()=>!N&&l(g),type:"button",disabled:N,className:["relative h-9 rounded-lg text-[12px] flex items-center justify-center border",m?v:"bg-slate-50 text-slate-400","border-slate-200 text-slate-800",N?"opacity-60 cursor-not-allowed":"hover:bg-slate-50",w||k?"ring-2 ring-emerald-500 bg-emerald-50 font-semibold":"",C?"bg-emerald-100/40":""].join(" "),style:f?{backgroundImage:"repeating-linear-gradient(135deg, rgba(239,68,68,.36) 0, rgba(239,68,68,.36) 10px, transparent 10px, transparent 20px)"}:y?{backgroundImage:"repeating-linear-gradient(45deg, rgba(16,185,129,.22) 0, rgba(16,185,129,.22) 6px, transparent 6px, transparent 12px)"}:void 0,"aria-label":g,title:f?"Indisponible":b?"Pass\xe9":y?`Minimum ${i} nuits`:"S\xe9lectionner",children:[e.getDate(),D&&s.jsx("span",{className:"absolute -bottom-1 h-1.5 w-1.5 rounded-full bg-emerald-600"})]},c)})})]})}function g(e){return(e||0).toLocaleString("fr-FR",{style:"currency",currency:"EUR"})}function f(){let e=((0,n.useSearchParams)().get("tab")||"C1").toUpperCase(),[t,r]=(0,a.useState)(e),[o,d]=(0,a.useState)({}),[c,u]=(0,a.useState)(2),[m,x]=(0,a.useState)(0),[p,f]=(0,a.useState)(""),[b,j]=(0,a.useState)(null),v=b?.valueCents??0,y=l[t],N=y.maxGuests??2,w=c+m,k=(0,a.useMemo)(()=>o?.nights?g(Math.max(0,(o.total||0)-v)):"",[o,v]),C=w<1?"Merci d’indiquer au moins 1 adulte.":w>N?`Capacit\xe9 max : ${N} personne${N>1?"s":""}.`:c<1?"Au moins 1 adulte requis.":"";async function D(){try{if(!p?.trim())return;if(!o?.checkIn||!o?.checkOut){alert("Choisis d’abord tes dates");return}let e=await fetch("/api/gift/redeem",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:p.trim().toUpperCase(),chalet:t,checkIn:o.checkIn,checkOut:o.checkOut})}),r=await e.json();if(!e.ok){alert(r.error||"Code invalide"),j(null);return}j(r)}catch(e){alert(e.message)}}function S(){j(null),f("")}return(0,s.jsxs)("div",{children:[s.jsx(i.default,{}),s.jsx("div",{className:"h-16 md:h-16"}),(0,s.jsxs)("section",{className:"max-w-6xl mx-auto px-4 py-12 md:py-16",children:[s.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:"R\xe9server"}),s.jsx("p",{className:"mt-2 text-stone-600",children:"Choisis ton chalet puis tes dates."}),s.jsx("div",{className:"mt-6 inline-flex rounded-xl border border-stone-200 overflow-hidden",children:["C1","C2"].map(e=>s.jsx("button",{onClick:()=>{r(e),S()},className:`px-4 py-2 text-sm ${t===e?"bg-emerald-900 text-white":"bg-white hover:bg-stone-50"}`,children:l[e].name},e))}),(0,s.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"mr-2 text-stone-700",children:"Adultes :"}),s.jsx("select",{value:c,onChange:e=>{let t=+e.target.value;u(t),t+m>N&&x(Math.max(0,N-t))},className:"rounded-xl border border-stone-300 px-2 py-1",children:Array.from({length:N},(e,t)=>t+1).map(e=>s.jsx("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"mr-2 text-stone-700",children:"Enfants :"}),s.jsx("select",{value:m,onChange:e=>{let t=+e.target.value;c+t>N||x(t)},className:"rounded-xl border border-stone-300 px-2 py-1",children:Array.from({length:Math.max(0,N-c+1)},(e,t)=>t).map(e=>s.jsx("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{className:"text-stone-500",children:["Capacit\xe9 : max ",N," pers."]})]}),C&&s.jsx("div",{className:"mt-2 text-sm text-red-700",children:C}),s.jsx("div",{className:"mt-6",children:["C1","C2"].includes(t)&&(0,s.jsxs)(s.Fragment,{children:[s.jsx(h,{chaletId:t,months:3,onChange:d}),(0,s.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[s.jsx("input",{value:p,onChange:e=>f(e.target.value),placeholder:"Code cadeau",className:"rounded-xl border border-stone-300 px-3 py-2"}),s.jsx("button",{onClick:D,className:"px-3 py-2 rounded-xl border",children:"Appliquer"}),b&&s.jsx("button",{onClick:S,className:"text-sm text-stone-600 underline",children:"Retirer"})]}),(0,s.jsxs)("div",{className:"mt-6 flex flex-wrap items-center gap-3",children:[s.jsx("div",{className:"text-sm text-stone-700",children:o?.nights>0?(0,s.jsxs)(s.Fragment,{children:["S\xe9jour de ",s.jsx("b",{children:o.nights})," nuit",o.nights>1?"s":""," —"," ",b?(0,s.jsxs)(s.Fragment,{children:[s.jsx("span",{className:"line-through mr-1",children:g(o.total)}),s.jsx("b",{children:k})," ",(0,s.jsxs)("span",{className:"text-emerald-800",children:["(",b.message,")"]})]}):s.jsx("b",{children:g(o.total)})," ","— caution ",g(l[t].deposit)]}):"S\xe9lectionne tes dates pour voir le total"}),s.jsx("button",{onClick:function(){let{checkIn:e,checkOut:t,nights:r,total:s}=o,a=Math.max(0,(s||0)-v),n=new URLSearchParams({chalet:y.id,ci:e,co:t,nights:String(r),amount:String(a/100*100),deposit:String(y.deposit),adults:String(c),children:String(m),...b?{giftCode:p.trim().toUpperCase(),giftValue:String(v)}:{}}).toString();location.assign(`/payer?${n}`)},disabled:!o?.valid||!!C,className:`px-4 py-2 rounded-xl ${!o?.valid||C?"bg-stone-200 text-stone-500 cursor-not-allowed":"bg-emerald-900 text-white"}`,children:"R\xe9server maintenant"})]})]})})]})]})}},8249:(e,t,r)=>{"use strict";r.d(t,{default:()=>d});var s=r(326),a=r(434),n=r(918),i=r.n(n);function l({className:e=""}){return(0,s.jsxs)(a.default,{href:"/","aria-label":"Accueil — Les Chalets Ty-Koad",className:`flex items-center gap-3 ${e}`,children:[s.jsx(o,{className:"h-8 w-8 text-emerald-900"}),(0,s.jsxs)("span",{className:`${i().className} text-lg md:text-xl leading-none tracking-wide`,children:["Les Chalets ",s.jsx("span",{className:"text-emerald-900",children:"Ty-Koad"})]})]})}function o({className:e=""}){return s.jsx("svg",{viewBox:"0 0 24 24",className:e,fill:"none",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:(0,s.jsxs)("g",{transform:"translate(12 12)",children:[(0,s.jsxs)("g",{children:[s.jsx("path",{d:"M0 -6a6 6 0 1 1 -4.24 1.76"}),s.jsx("circle",{cx:"0",cy:"-6",r:"1.4",fill:"currentColor",stroke:"none"})]}),(0,s.jsxs)("g",{transform:"rotate(120)",children:[s.jsx("path",{d:"M0 -6a6 6 0 1 1 -4.24 1.76"}),s.jsx("circle",{cx:"0",cy:"-6",r:"1.4",fill:"currentColor",stroke:"none"})]}),(0,s.jsxs)("g",{transform:"rotate(240)",children:[s.jsx("path",{d:"M0 -6a6 6 0 1 1 -4.24 1.76"}),s.jsx("circle",{cx:"0",cy:"-6",r:"1.4",fill:"currentColor",stroke:"none"})]})]})})}function d(){return s.jsx("header",{id:"site-header",style:{position:"fixed",top:0,left:0,right:0,zIndex:2147483647},className:"bg-white/90 backdrop-blur border-b border-emerald-100 shadow-sm",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[s.jsx(l,{}),(0,s.jsxs)("nav",{className:"hidden md:flex items-center gap-6 text-sm text-stone-700",children:[s.jsx(a.default,{href:"/nuit",className:"hover:text-emerald-800",children:"Douce nuit"}),s.jsx(a.default,{href:"/spa",className:"hover:text-rose-700",children:"Spa privatif"}),s.jsx(a.default,{href:"/autour",className:"hover:text-sky-700",children:"Autour"}),s.jsx(a.default,{href:"/gourmets",className:"hover:text-emerald-800",children:"Gourmets"}),s.jsx(a.default,{href:"/infos-pratiques",className:"hover:text-emerald-800",children:"Infos pratiques"}),s.jsx(a.default,{href:"/cadeau",className:"hover:text-rose-700",children:"Ch\xe8que cadeau"}),s.jsx(a.default,{href:"/contact",className:"hover:text-sky-700",children:"Contact"}),s.jsx(a.default,{href:"/reserver",className:"px-4 py-2 rounded-xl bg-emerald-700 hover:bg-emerald-800 text-white shadow-sm",children:"R\xe9server"})]}),s.jsx(a.default,{href:"/reserver",className:"md:hidden px-3 py-1 rounded-lg bg-emerald-700 hover:bg-emerald-800 text-white text-sm shadow-sm",children:"R\xe9server"})]})})}},5047:(e,t,r)=>{"use strict";var s=r(7389);r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},7764:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,metadata:()=>a});var s=r(9510);r(7272);let a={title:"Ty-Koad — V5.x",description:"Paiement, caution, iCal, admin"};function n({children:e}){return s.jsx("html",{lang:"fr",children:s.jsx("body",{className:" min-h-screen bg-gradient-to-br from-emerald-50 via-sky-50 to-rose-50 text-stone-900 ",children:e})})}},7362:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var s=r(8570);let a=(0,s.createProxy)(String.raw`C:\Users\Nina\Downloads\ty-koad-v5_1\ty-koad-demo-v5.1\app\reserver\page.jsx`),{__esModule:n,$$typeof:i}=a;a.default;let l=(0,s.createProxy)(String.raw`C:\Users\Nina\Downloads\ty-koad-v5_1\ty-koad-demo-v5.1\app\reserver\page.jsx#default`)},7272:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,471,552],()=>r(7634));module.exports=s})();